/*! plainterm.js
https://github.com/mkrl/plainterm.js#readme
2018-10-24 */

Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode,n=window.getComputedStyle(t,null),o=parseInt(n.getPropertyValue("border-top-width")),i=parseInt(n.getPropertyValue("border-left-width")),s=this.offsetTop-t.offsetTop<t.scrollTop,a=this.offsetTop-t.offsetTop+this.clientHeight-o>t.scrollTop+t.clientHeight,r=this.offsetLeft-t.offsetLeft<t.scrollLeft,l=this.offsetLeft-t.offsetLeft+this.clientWidth-i>t.scrollLeft+t.clientWidth;e?((s||a)&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-o+this.clientHeight/2),(r||l)&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-i+this.clientWidth/2)):(s&&(t.scrollTop=this.offsetTop-t.offsetTop-o),a&&(t.scrollTop=this.offsetTop-t.offsetTop-o-t.clientHeight+this.clientHeight),r&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-i),l&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-i-t.clientWidth+this.clientWidth))});var plainterm=function(){var e={commands:{},history:[],last:0,process:!1,version:"0.4.4"};function t(e,t,n,i=[]){if(this.name=e,this.description=t,this.parameters=i,i.length>0){var s="";for(var a of i)s=s+" ["+a+"]";this.func=function(t){!1===(t=t||!1)||t.length<i.length?o("usage: "+e+s):n(t)}}else this.func=n}function n(n){e.commands[n.name]=new t(n.name,n.description,n.func,n.parameters)}function o(t,n=!1){var o=document.createElement("p");if(!0===n){var i=document.createElement("span");i.innerHTML=t,i.className="termainal-command",o.innerHTML=e.prompt,e.container.display.appendChild(o),o.appendChild(i)}else o.innerHTML=t,e.container.display.appendChild(o),e.container.input.scrollIntoViewIfNeeded()}function i(t){var n=t.split(/\s+/),i=n[0];n.shift();var s=new CustomEvent("onCommand"),a=new CustomEvent("onCommand404");Object.getOwnPropertyNames(e.commands).indexOf(i)>-1?(e.commands[i].func(n),e.history.unshift(t),e.container.dispatchEvent(s)):(o('<span class="terminal-error">'+i+" - command not found</span>"),e.container.dispatchEvent(a))}function s(t=!0){e.history.length>0&&(!0===t&&e.last<e.history.length-1?(e.container.input.value=e.history[e.last],e.last++):!1===t&&e.last>0&&(e.container.input.value=e.history[e.last],e.last--))}return document.addEventListener("keydown",function(e){e.key;switch(e.key){case"ArrowUp":s();break;case"ArrowDown":s(!1)}}),{init:function(i){for(var s of(i.id=i.id||"terminal",i.welcome=i.welcome||"plainterm.js v. "+e.version,i.prompt='<span class="terminal-prompt">'+i.prompt+"</span>"||'<span class="terminal-prompt">$ </span>',e.prompt=i.prompt,void 0===i.help&&(i.help=!0),Object.keys(i.commands)))n(i.commands[s]);e.container=document.getElementById(i.id),function(t){t.className="terminal";var n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("span");i.innerHTML=e.prompt;var s=document.createElement("input");for(var a of(n.className="terminal-container",o.className="terminal-type",s.setAttribute("type","text"),s.setAttribute("onkeypress","plainterm.eval(this)"),t.appendChild(n),t.appendChild(o),document.getElementsByClassName("terminal-type")))a.appendChild(i),a.appendChild(s);e.container.display=t.firstElementChild,e.container.input=s,e.container.area=o,t.onclick=function(){s.focus()}}(e.container),o(i.welcome);var a=new CustomEvent("onInit");!0===i.help&&(e.commands.help=new t("help","shows a help message",function(){Object.getOwnPropertyNames(e.commands).map(function(t){o(e.commands[t].name+" - "+e.commands[t].description)})})),e.container.dispatchEvent(a)},run:i,eval:function(t){13==event.keyCode&&(o(t.value,!0),t.value.length>0&&i(t.value),t.value="",e.last=0,e.container.input.scrollIntoViewIfNeeded())},print:o,hist:s,type:function(t,n,o=!1){e.container.area.style.display="none";var i=document.createElement("p");e.container.display.appendChild(i),!0===o&&(i.innerHTML=e.prompt);var s=0;setTimeout(function o(){s<t.length?(i.innerHTML+=t.charAt(s),s++,setTimeout(o,n),i.scrollIntoViewIfNeeded()):!1===e.process&&(e.container.area.style.display="flex")},n),e.container.input.scrollIntoViewIfNeeded()},start:function(){e.container.area.style.display="none",e.process=!0,e.prompt="";var t=new CustomEvent("onProcessStart");e.container.dispatchEvent(t)},stop:function(){e.container.area.style.display="flex",e.process=!1,e.prompt=settings.prompt;var t=new CustomEvent("onProcessStop");e.container.dispatchEvent(t)}}}();